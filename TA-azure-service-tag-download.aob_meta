{"basic_builder": {"appname": "TA-azure-service-tag-download", "friendly_name": "Azure Service tag download", "version": "1.0.1", "author": "Vignesh Narendran", "description": "This app downloads json from Microsoft and indexes into events\nhttps://www.microsoft.com/en-us/download/confirmation.aspx?id=56519", "theme": "#297ba5", "large_icon": "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", "small_icon": "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", "visible": false, "tab_version": "4.1.2", "tab_build_no": "0", "build_no": 4}, "data_input_builder": {"datainputs": [{"index": "default", "sourcetype": "info:azure:servicetag", "interval": "600", "use_external_validation": true, "streaming_mode_xml": true, "name": "public_ip", "title": "public ip", "description": "", "type": "customized", "parameters": [{"name": "download_url", "label": "Download URL", "help_string": "", "required": true, "format_type": "text", "default_value": "https://www.microsoft.com/en-us/download/confirmation.aspx?id=56519", "placeholder": "https://www.microsoft.com/en-us/download/confirmation.aspx?id=56519", "type": "text", "value": "https://www.microsoft.com/en-us/download/confirmation.aspx?id=56519"}], "data_inputs_options": [{"type": "customized_var", "name": "download_url", "title": "Download URL", "description": "", "required_on_edit": false, "required_on_create": true, "format_type": "text", "default_value": "https://www.microsoft.com/en-us/download/confirmation.aspx?id=56519", "placeholder": "https://www.microsoft.com/en-us/download/confirmation.aspx?id=56519"}], "code": "\n\n# encoding = utf-8\n\n\n\nimport os\n\nimport sys\n\nimport time\n\nimport datetime\n\nimport re\n\nimport logging\n\nimport urllib\n\nfrom urllib import request\n\nimport requests\n\nfrom lxml import html\n\nimport json\n\n\n\ndef validate_input(helper, definition):\n\n    pass\n\n\n\ndef collect_events(helper, ew):\n\n    # init values\n\n    url=helper.get_arg('download_url')\n\n    index=helper.get_arg('index')\n\n    deep_link = \"\"\n\n    file_name = \"\"\n\n    latest_date = 0\n\n\n\n    # get and set the meta values for each event\n\n    input_name = helper.get_input_stanza_names()\n\n    sourcetype = helper.get_sourcetype()\n\n    source = \"azure://{}\".format(input_name)\n\n    host = 'localhost'\n\n    \n\n\n\n    def index_events(response):\n\n        obj = response.json()\n\n        helper.log_info(\"Azure ServiceTags Download completed. Status=Completed Filename={}\".format(deep_link))\n\n        items = obj.get(\"values\",[])\n\n        input_name = helper.get_input_stanza_names()\n\n        source = \"azure://{}\".format(input_name)\n\n        helper.log_debug(\"Azure ServiceTags parsing\") \n\n        \n\n        # Write each item as an event    \n\n        for i in range(len(items)):\n\n            text=json.dumps(items[i])\n\n            event=helper.new_event(\n\n                text,\n\n                time=datetime.datetime.now(),\n\n                host=host,\n\n                index=index,\n\n                source=source,\n\n                sourcetype=sourcetype,\n\n                done=True,\n\n                unbroken=True\n\n            )\n\n            ew.write_event(event)\n\n            helper.log_debug(\"wrote : {}\".format(text))\n\n        \n\n        helper.log_info(\"Azure ServiceTags Indexing complete. Wrote {} events into index={} sourcetype={}\".format(len(items),index,sourcetype))\n\n \n\n    def get_check_point():\n\n        #helper.save_check_point(\"latest_time\",0)\n\n        checkpoint = helper.get_check_point(\"latest_time\")\n\n        \n\n        if checkpoint is None:\n\n            helper.log_info(\"Initialize checkpoint to 0\")\n\n            checkpoint=0\n\n        else:\n\n            helper.log_info(\"Checkpoint is at : {}\".format(checkpoint))\n\n            checkpoint=int(checkpoint)\n\n        return checkpoint\n\n    \n\n    def get_download_link():\n\n        headers = {\n\n            'Content-Type': 'application/json'\n\n        }\n\n        \n\n        try:\n\n            response = helper.send_http_request(url, \"GET\", headers=headers, timeout=120)\n\n            response.raise_for_status()\n\n            \n\n            helper.log_debug(\"RESPONSE : {}\".format(response.content))\n\n            tree = html.fromstring(response.content)\n\n            \n\n            helper.log_debug(\"TREE : {}\".format(tree))\n\n            \n\n            element = tree.xpath('//*[@data-bi-id=\"downloadretry\"]')\n\n            deep_link = element[0].attrib[\"href\"]\n\n            helper.log_debug(\"DEEPLINK : {}\".format(deep_link))\n\n            # Validate the data file name from the deep link \n\n            file_name_pattern = re.compile('(ServiceTags_Public_\\d+\\.json$)')\n\n            file_name_matched = file_name_pattern.search(deep_link)\n\n            file_name = file_name_matched.group(1)\n\n        except Exception as e:\n\n            helper.log_error(\"Exception on getting deep_link : {}\".format(e))\n\n            os._exit(1)\n\n\n\n        if not file_name:\n\n            helper.log_error(\"Invalid file name : {} from the deep link : {} \".format(file_name,deep_link))   \n\n        \n\n        return deep_link\n\n    \n\n    def decide_download_index(checkpoint,latest_date):\n\n        if latest_date > checkpoint:\n\n            try:\n\n                headers = {\n\n                    'Content-Type': 'application/json'\n\n                }\n\n                \n\n                response = helper.send_http_request(deep_link, \"GET\", headers=headers, timeout=200)\n\n                helper.log_info(\"Download file : {} initiated\".format(file_name))\n\n                index_events(response)\n\n            except Exception as e:\n\n                helper.log_error(\"Exception on download & indexing : {}\".format(e))\n\n                os._exit(1)\n\n    \n\n            helper.save_check_point(\"latest_time\",latest_date)\n\n            helper.log_info(\"setting checkpoint to : {}\".format(str(latest_date)))\n\n        \n\n        else:\n\n            helper.log_info(\"Ignoring download of already indexed file\")\n\n        \n\n    deep_link=get_download_link()\n\n    date=re.search(r\"(\\d{8})\",deep_link)\n\n    latest_date = int(date.group(0))\n\n    checkpoint=get_check_point()\n\n    decide_download_index(checkpoint,latest_date)\n\n    ", "customized_options": [{"name": "download_url", "value": "https://www.microsoft.com/en-us/download/confirmation.aspx?id=56519"}], "uuid": "e440226c801f49c28d0bd58c8cd8f7bc", "sample_count": 0}]}, "field_extraction_builder": {"info:azure:servicetag": {"is_parsed": true, "data_format": "json"}}, "global_settings_builder": {"global_settings": {"log_settings": {}}}, "sourcetype_builder": {"info:azure:servicetag": {"metadata": {"event_count": 0, "data_input_name": "public_ip", "extractions_count": 0, "cims_count": 0}}}, "validation": {"validators": ["best_practice_validation", "data_model_mapping_validation", "field_extract_validation", "app_cert_validation"], "status": "job_finished", "validation_id": "v_1681152293_14", "progress": 1.0}}